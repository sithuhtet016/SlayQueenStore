import{a as u,p as I}from"./chunk-WWGJGFF6-ES-ljSok.js";const p=u.createContext(void 0);function y(){if(typeof window>"u")return[];try{const r=window.localStorage.getItem("cart");if(!r)return[];const e=JSON.parse(r);return Array.isArray(e)?e.map(i=>({productId:i.productId,variantId:i.variantId,quantity:i.quantity??1})):[]}catch{return[]}}function g({children:r}){const[e,i]=u.useState(()=>y());u.useEffect(()=>{typeof window>"u"||window.localStorage.setItem("cart",JSON.stringify(e))},[e]);const w=(n,o,c=1)=>{i(d=>{const t=[...d],a=t.findIndex(s=>s.productId===n&&s.variantId===o);return a>=0?t[a]={...t[a],quantity:t[a].quantity+c}:t.push({productId:n,variantId:o,quantity:c}),t})},f=u.useCallback((n,o,c)=>{i(d=>{if(c<=0)return d.filter(s=>!(s.productId===n&&s.variantId===o));const t=[...d],a=t.findIndex(s=>s.productId===n&&s.variantId===o);return a>=0?(t[a]={...t[a],quantity:c},t):(t.push({productId:n,variantId:o,quantity:c}),t)})},[]),x=u.useMemo(()=>e.reduce((n,o)=>n+o.quantity,0),[e]),l=u.useCallback(()=>{i([]),typeof window<"u"&&window.localStorage.removeItem("cart")},[]),C=u.useMemo(()=>({items:e,cartCount:x,addToCart:w,updateQuantity:f,clearCart:l}),[e,x,f,l]);return I.jsx(p.Provider,{value:C,children:r})}function v(){const r=u.useContext(p);if(!r)throw new Error("useCart must be used within a CartProvider");return r}export{g as C,v as u};
